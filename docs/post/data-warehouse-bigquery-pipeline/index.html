<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script type=application/javascript src=https://joaoblasques.com/js/theme-mode.js></script><link rel=stylesheet href=https://joaoblasques.com/css/frameworks.min.css><link rel=stylesheet href=https://joaoblasques.com/css/github.min.css><link rel=stylesheet href=https://joaoblasques.com/css/github-style.css><link rel=stylesheet href=https://joaoblasques.com/css/light.css><link rel=stylesheet href=https://joaoblasques.com/css/dark.css><link rel=stylesheet href=https://joaoblasques.com/css/syntax.css><title>Building a Data Pipeline with BigQuery: From Storage to Analytics - João Blasques | AI-Enabled Data Engineer</title><link rel=icon type=image/x-icon href=/images/favicon.ico><meta name=theme-color content="#1e2327"><link rel=stylesheet href=https://joaoblasques.com/css/custom.css><meta name=description content="Project Overview This project demonstrates the implementation of a comprehensive data pipeline using Google BigQuery as the primary data warehouse solution. The pipeline showcases modern data engineering practices including external data integration, table optimization strategies, and performance tuning techniques.
Repository: Data Pipeline with BigQuery
The project focuses on building a scalable, cost-effective data warehouse solution that can handle large volumes of NYC taxi trip data while maintaining optimal query performance and cost efficiency.
Key Concepts • OLAP vs OLTP: Understanding the fundamental differences between Online Analytical Processing and Online Transaction Processing systems • Data Warehousing: Implementing centralized storage for analytical workloads with optimized query performance • Table Partitioning: Dividing large tables into manageable chunks based on time or range values • Clustering: Organizing data within partitions to improve query performance and reduce costs • External Tables: Querying data stored outside BigQuery without incurring storage costs • Performance Optimization: Implementing best practices for cost reduction and query efficiency
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://joaoblasques.com/post/data-warehouse-bigquery-pipeline/><meta name=twitter:card content="summary"><meta name=twitter:title content="Building a Data Pipeline with BigQuery: From Storage to Analytics - João Blasques | AI-Enabled Data Engineer"><meta name=twitter:description content="Project Overview This project demonstrates the implementation of a comprehensive data pipeline using Google BigQuery as the primary data warehouse solution. The pipeline showcases modern data engineering practices including external data integration, table optimization strategies, and performance tuning techniques.
Repository: Data Pipeline with BigQuery
The project focuses on building a scalable, cost-effective data warehouse solution that can handle large volumes of NYC taxi trip data while maintaining optimal query performance and cost efficiency.
Key Concepts • OLAP vs OLTP: Understanding the fundamental differences between Online Analytical Processing and Online Transaction Processing systems • Data Warehousing: Implementing centralized storage for analytical workloads with optimized query performance • Table Partitioning: Dividing large tables into manageable chunks based on time or range values • Clustering: Organizing data within partitions to improve query performance and reduce costs • External Tables: Querying data stored outside BigQuery without incurring storage costs • Performance Optimization: Implementing best practices for cost reduction and query efficiency
"><meta name=twitter:site content="https://joaoblasques.com/"><meta name=twitter:creator content><meta name=twitter:image content="https://joaoblasques.com/"><meta property="og:type" content="article"><meta property="og:title" content="Building a Data Pipeline with BigQuery: From Storage to Analytics - João Blasques | AI-Enabled Data Engineer"><meta property="og:description" content="Project Overview This project demonstrates the implementation of a comprehensive data pipeline using Google BigQuery as the primary data warehouse solution. The pipeline showcases modern data engineering practices including external data integration, table optimization strategies, and performance tuning techniques.
Repository: Data Pipeline with BigQuery
The project focuses on building a scalable, cost-effective data warehouse solution that can handle large volumes of NYC taxi trip data while maintaining optimal query performance and cost efficiency.
Key Concepts • OLAP vs OLTP: Understanding the fundamental differences between Online Analytical Processing and Online Transaction Processing systems • Data Warehousing: Implementing centralized storage for analytical workloads with optimized query performance • Table Partitioning: Dividing large tables into manageable chunks based on time or range values • Clustering: Organizing data within partitions to improve query performance and reduce costs • External Tables: Querying data stored outside BigQuery without incurring storage costs • Performance Optimization: Implementing best practices for cost reduction and query efficiency
"><meta property="og:url" content="https://joaoblasques.com/post/data-warehouse-bigquery-pipeline/"><meta property="og:site_name" content="Building a Data Pipeline with BigQuery: From Storage to Analytics"><meta property="og:image" content="https://joaoblasques.com/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2025-07-14 00:00:00 +0100 WEST"></head><body><div style=position:relative><header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"><div class="Header-item mobile-none" style=margin-top:-4px;margin-bottom:-4px><a class=Header-link href=https://joaoblasques.com/><img class=octicon height=32 width=32 src=/images/github-mark-white.png></a></div><div class="Header-item d-md-none"><button class="Header-link btn-link js-details-target" type=button onclick='document.querySelector("#header-search").style.display=document.querySelector("#header-search").style.display=="none"?"block":"none"'>
<svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button></div><div style=display:none id=header-search class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"><div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"><div class=position-relative><form target=_blank action=https://www.google.com/search accept-charset=UTF-8 method=get autocomplete=off><label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"><input type=text class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name=q placeholder=Search autocomplete=off>
<input type=hidden name=q value=site:https://joaoblasques.com/></label></form></div></div></div><div class="Header-item Header-item--full flex-justify-center d-md-none position-relative"><a class=Header-link href=https://joaoblasques.com/><img class="octicon octicon-mark-github v-align-middle" height=32 width=32 src=/images/github-mark-white.png></a></div><div class=Header-item style=margin-right:0><a href=javascript:void(0) class="Header-link no-select" onclick=switchTheme()><svg style="fill:var(--color-profile-color-modes-toggle-moon)" class="no-select" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></a></div></header></div><div id=search-result class="container-lg px-3 new-discussion-timeline" style=display:none></div><div class=application-main><div><main><div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4"><div class=px-0><div class="mb-3 d-flex px-3 px-md-3 px-lg-5"><div class="flex-auto min-width-0 width-fit mr-3"><div class=d-flex><div class="d-none d-md-block"><a class="avatar mr-2 flex-shrink-0" href=https://joaoblasques.com/><img class=avatar-user src=/images/avatar.jpg width=32 height=32></a></div><div class="d-flex flex-column"><h1 class="break-word f3 text-normal mb-md-0 mb-1"><span class=author><a href=https://joaoblasques.com/>João Blasques (Jonas)</a>
</span><span class=path-divider>/</span>
<strong class="css-truncate css-truncate-target mr-1" style=max-width:410px><a href=https://joaoblasques.com/post/data-warehouse-bigquery-pipeline/>Building a Data Pipeline with BigQuery: From Storage to Analytics</a></strong></h1><div class="note m-0">Created <relative-time datetime="Mon, 14 Jul 2025 00:00:00 +0100" class=no-wrap>Mon, 14 Jul 2025 00:00:00 +0100</relative-time></div></div></div></div></div></div></div><div class="container-lg px-3 new-discussion-timeline"><div class="repository-content gist-content"><div><div class="js-gist-file-update-container js-task-list-container file-box"><div id=file-pytest class="file my-2"><div id=post-header class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style=z-index:2><div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto"><div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0"><summary id=toc-toggle onclick=clickToc() class="btn btn-octicon m-0 mr-2 p-2"><svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zM3 8A1 1 0 111 8a1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/></svg></summary><details-menu class=SelectMenu id=toc-details style="display: none;"><div class="SelectMenu-modal rounded-3 mt-1" style=max-height:340px><div class="SelectMenu-list SelectMenu-list--borderless p-2" style=overscroll-behavior:contain id=toc-list></div></div></details-menu>832 Words</div><div class="file-actions flex-order-2 pt-0"><a class="muted-link mr-3" href=/tags/data-engineering><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
data engineering
</a><a class="muted-link mr-3" href=/tags/bigquery><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
bigquery
</a><a class="muted-link mr-3" href=/tags/data-warehouse><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
data warehouse
</a><a class="muted-link mr-3" href=/tags/cloud><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
cloud
</a><a class="muted-link mr-3" href=/tags/analytics><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
analytics
</a><a class="muted-link mr-3" href=/tags/partitioning><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
partitioning
</a><a class="muted-link mr-3" href=/tags/clustering><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
clustering
</a><a class="muted-link mr-3" href=/tags/nyc-taxi><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
nyc taxi</a></div></div></div><div class="Box-body px-5 pb-5" style=z-index:1><article class="markdown-body entry-content container-lg"><h2 id=project-overview>Project Overview</h2><p>This project demonstrates the implementation of a comprehensive data pipeline using Google BigQuery as the primary data warehouse solution. The pipeline showcases modern data engineering practices including external data integration, table optimization strategies, and performance tuning techniques.</p><p><strong>Repository:</strong> <a href=https://github.com/jonasblasques/4-data-pipeline-datawarehouse-bigquery>Data Pipeline with BigQuery</a></p><p>The project focuses on building a scalable, cost-effective data warehouse solution that can handle large volumes of NYC taxi trip data while maintaining optimal query performance and cost efficiency.</p><h2 id=key-concepts>Key Concepts</h2><p>• <strong>OLAP vs OLTP:</strong> Understanding the fundamental differences between Online Analytical Processing and Online Transaction Processing systems
• <strong>Data Warehousing:</strong> Implementing centralized storage for analytical workloads with optimized query performance
• <strong>Table Partitioning:</strong> Dividing large tables into manageable chunks based on time or range values
• <strong>Clustering:</strong> Organizing data within partitions to improve query performance and reduce costs
• <strong>External Tables:</strong> Querying data stored outside BigQuery without incurring storage costs
• <strong>Performance Optimization:</strong> Implementing best practices for cost reduction and query efficiency</p><h2 id=understanding-data-warehouse-architecture>Understanding Data Warehouse Architecture</h2><h3 id=olap-vs-oltp-systems>OLAP vs OLTP Systems</h3><p>Modern data architectures distinguish between two primary database paradigms:</p><p><strong>OLTP (Online Transaction Processing)</strong> systems are designed for real-time business operations with fast, small updates and normalized data structures. These systems excel at handling concurrent transactions and maintaining data consistency.</p><p><strong>OLAP (Online Analytical Processing)</strong> systems, like BigQuery, are optimized for analytical workloads with large-scale data processing and denormalized structures. They&rsquo;re designed for discovering insights from historical data rather than managing daily transactions.</p><table><thead><tr><th>Aspect</th><th>OLTP</th><th>OLAP</th></tr></thead><tbody><tr><td>Purpose</td><td>Real-time business operations</td><td>Analytics and reporting</td></tr><tr><td>Data Updates</td><td>Fast, small, user-initiated</td><td>Batch jobs, periodic refresh</td></tr><tr><td>Database Design</td><td>Normalized for efficiency</td><td>Denormalized for analysis</td></tr><tr><td>Data Volume</td><td>Generally smaller</td><td>Large datasets</td></tr></tbody></table><h3 id=bigquery-as-a-data-warehouse-solution>BigQuery as a Data Warehouse Solution</h3><p>BigQuery serves as Google Cloud&rsquo;s fully managed, serverless data warehouse that separates compute from storage, enabling:</p><ul><li><strong>Serverless Architecture:</strong> No infrastructure management required</li><li><strong>Massive Scalability:</strong> Handle petabytes of data efficiently</li><li><strong>Cost Optimization:</strong> Pay only for queries processed and storage used</li><li><strong>Built-in Features:</strong> Machine learning, geospatial analysis, and BI integration</li></ul><h2 id=implementation-nyc-taxi-data-pipeline>Implementation: NYC Taxi Data Pipeline</h2><h3 id=creating-external-tables>Creating External Tables</h3><p>The pipeline begins by creating external tables that reference data stored in Google Cloud Storage without importing it into BigQuery:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>REPLACE</span> <span style=color:#66d9ef>EXTERNAL</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#f92672>`</span>taxi<span style=color:#f92672>-</span>rides<span style=color:#f92672>-</span>ny.nytaxi.external_yellow_tripdata<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>OPTIONS</span> (
</span></span><span style=display:flex><span>  format <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CSV&#39;</span>,
</span></span><span style=display:flex><span>  uris <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;gs://nyc-tl-data/trip data/yellow_tripdata_2019-*.csv&#39;</span>, 
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#39;gs://nyc-tl-data/trip data/yellow_tripdata_2020-*.csv&#39;</span>]
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>This approach provides several advantages:</p><ul><li>Zero storage costs in BigQuery</li><li>Automatic schema detection</li><li>Immediate data availability</li><li>Flexible data source management</li></ul><h3 id=table-partitioning-strategy>Table Partitioning Strategy</h3><p>Partitioning divides large tables into smaller, manageable segments based on a column value. For the taxi data, partitioning by pickup datetime provides significant performance improvements:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>REPLACE</span> <span style=color:#66d9ef>TABLE</span> taxi<span style=color:#f92672>-</span>rides<span style=color:#f92672>-</span>ny.nytaxi.yellow_tripdata_partitioned
</span></span><span style=display:flex><span>PARTITION <span style=color:#66d9ef>BY</span> DATE(tpep_pickup_datetime) <span style=color:#66d9ef>AS</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> taxi<span style=color:#f92672>-</span>rides<span style=color:#f92672>-</span>ny.nytaxi.external_yellow_tripdata;
</span></span></code></pre></div><p><strong>Performance Impact:</strong></p><ul><li>Non-partitioned table: 1.6 GB processed for date range queries</li><li>Partitioned table: 106 MB processed for the same query</li><li><strong>85% reduction in data processing costs</strong></li></ul><h3 id=advanced-optimization-clustering>Advanced Optimization: Clustering</h3><p>Clustering organizes data within partitions based on column values, further improving query performance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>REPLACE</span> <span style=color:#66d9ef>TABLE</span> taxi<span style=color:#f92672>-</span>rides<span style=color:#f92672>-</span>ny.nytaxi.yellow_tripdata_partitioned_clustered
</span></span><span style=display:flex><span>PARTITION <span style=color:#66d9ef>BY</span> DATE(tpep_pickup_datetime)
</span></span><span style=display:flex><span><span style=color:#66d9ef>CLUSTER</span> <span style=color:#66d9ef>BY</span> VendorID <span style=color:#66d9ef>AS</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> taxi<span style=color:#f92672>-</span>rides<span style=color:#f92672>-</span>ny.nytaxi.external_yellow_tripdata;
</span></span></code></pre></div><p><strong>Additional Performance Gains:</strong></p><ul><li>Partitioned only: 1.1 GB processed</li><li>Partitioned + Clustered: 843 MB processed</li><li><strong>25% additional cost reduction</strong></li></ul><h2 id=best-practices-for-production>Best Practices for Production</h2><h3 id=cost-optimization-strategies>Cost Optimization Strategies</h3><ol><li><strong>Avoid SELECT *:</strong> Always specify required columns to reduce processed data</li><li><strong>Query Pricing:</strong> Use BigQuery&rsquo;s query validator to estimate costs before execution</li><li><strong>Materialized Views:</strong> Store intermediate results for complex, frequently-used queries</li><li><strong>Streaming Inserts:</strong> Use cautiously as they can significantly increase costs</li></ol><h3 id=query-performance-optimization>Query Performance Optimization</h3><ol><li><strong>Filter on Partitioned Columns:</strong> Always include partition filters in WHERE clauses</li><li><strong>Data Denormalization:</strong> Reduce JOIN operations by combining related data</li><li><strong>Nested/Repeated Columns:</strong> Use BigQuery&rsquo;s native support for complex data structures</li><li><strong>Approximate Functions:</strong> Use APPROX_COUNT_DISTINCT for faster aggregations on large datasets</li></ol><h3 id=example-optimized-query-pattern>Example: Optimized Query Pattern</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Efficient query with proper filtering and column selection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>  VendorID,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>as</span> trip_count,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AVG</span>(trip_distance) <span style=color:#66d9ef>as</span> avg_distance
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> taxi<span style=color:#f92672>-</span>rides<span style=color:#f92672>-</span>ny.nytaxi.yellow_tripdata_partitioned_clustered
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> DATE(tpep_pickup_datetime) <span style=color:#66d9ef>BETWEEN</span> <span style=color:#e6db74>&#39;2019-06-01&#39;</span> <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;2019-06-30&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> VendorID <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> VendorID;
</span></span></code></pre></div><h2 id=scalability-and-advanced-features>Scalability and Advanced Features</h2><h3 id=columnar-storage-architecture>Columnar Storage Architecture</h3><p>BigQuery&rsquo;s columnar storage format provides significant advantages for analytical workloads:</p><ul><li><strong>Selective Column Reading:</strong> Only required columns are processed</li><li><strong>Compression Efficiency:</strong> Better compression ratios for similar data types</li><li><strong>Parallel Processing:</strong> Multiple workers can process different columns simultaneously</li></ul><h3 id=automatic-maintenance>Automatic Maintenance</h3><p>BigQuery handles several optimization tasks automatically:</p><ul><li><strong>Automatic Reclustering:</strong> Maintains clustering benefits as new data arrives</li><li><strong>Query Optimization:</strong> Dremel engine optimizes query execution plans</li><li><strong>Storage Management:</strong> Handles data distribution and replication</li></ul><h2 id=conclusion>Conclusion</h2><p>This project demonstrates how to build a robust, scalable data pipeline using BigQuery&rsquo;s advanced features. The implementation showcases critical data engineering concepts including:</p><ul><li>Strategic use of external tables for cost-effective data access</li><li>Partitioning and clustering strategies that deliver measurable performance improvements</li><li>Production-ready optimization techniques for both cost and performance</li></ul><p>The pipeline achieves significant cost reductions (up to 85%) while maintaining query performance, making it suitable for production environments handling large-scale analytical workloads.</p><p>By leveraging BigQuery&rsquo;s serverless architecture and advanced optimization features, organizations can build data warehouses that scale efficiently while controlling costs—a crucial capability in today&rsquo;s data-driven landscape.</p><p><strong>Next Steps:</strong> Consider implementing real-time streaming ingestion, advanced ML features, or integration with visualization tools like Looker or Data Studio to extend the pipeline&rsquo;s capabilities.</p></article></div></div></div></div></div></div></main></div><script type=application/javascript src=https://joaoblasques.com/js/toc.js></script><link rel=stylesheet href=https://joaoblasques.com/css/toc.css></div><div class="footer container-xl width-full p-responsive"><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><a aria-label=Homepage title=GitHub class="footer-octicon d-none d-lg-block mr-lg-4" href=https://joaoblasques.com/><svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"><li class="mr-3 mr-lg-0">Theme by <a href=https://github.com/MeiK2333/github-style>github-style</a></li><li class="mr-3 mr-lg-0">GitHub and the Invertocat logo are trademarks of <a href=https://github.com/>GitHub, Inc.</a></li></ul></div><div class="d-flex flex-justify-center pb-6"><span class="f6 text-gray-light"></span></div></div></body><script type=application/javascript src=https://joaoblasques.com/js/github-style.js></script></html>